<!--
    LWC Name           : lwcCustomerSearchKreditComponent.html
    Created Date       : 16 September 2024
    @description       : This is class ..
    @author            : Rakeyan Nuramria
    Modification Log :
    Ver   Date         Author                            Modification
    1.0   12/09/2024   Rakeyan Nuramria                  Initial Version
    1.0   25/09/2024   Rakeyan Nuramria                  Adjust UI for API
    1.0   09/10/2024   Ardyta Yudianto                   [FROM SIT] Adjust UI to scrollable horizontally
-->

<template>

    <!-- Search Section -->
    <lightning-card title="" variant="base" class="custom-card slds-m-top_xx-small slds-card_boundary">
        <div class="slds-grid slds-gutters slds-m-around_small">
            <div class="slds-col">
                <lightning-input label="Kartu Kredit" value={noKredit} onchange={handleKreditChange}
                    disabled={disableKreditField}></lightning-input>
            </div>
            <div class="slds-col" style="align-content: center; margin-top: 20px">
                <!-- <lightning-button label="Cari" variant="brand" onclick={handleSearch}
                    disabled={isHandleSearchDisabled}></lightning-button> -->
                <lightning-button label="Cari" variant="brand" onclick={handleSearchByCardlink}
                    disabled={isHandleSearchDisabled}></lightning-button>
            </div>
        </div>

        <template if:true={errorMessage}>
            <div class="slds-text-color_error slds-m-left_small">
                {errorMessage}
            </div>
        </template>
    </lightning-card>
    <!-- End Search Section -->

    <!-- Result Data Section -->
    <!-- Spinner Section -->
    <template if:true={isLoading}>
        <lightning-card icon-name="" variant="base" class="custom-card slds-m-around_small slds-card_boundary">
            <div class="slds-is-relative slds-align_absolute-center slds-m-around_small">
                <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
            </div>
        </lightning-card>
    </template>

    <template if:false={isLoading}>
        <template if:true={hasError}>
            <div class="slds-text-color_error slds-m-top_medium slds-text-align_center">
                <b>{errorMsg}</b>
            </div>
        </template>

        <!-- <template if:true={customerData.length}> -->
        <template if:true={dataKredit.length}>
            <!-- Kredit Portofolio Section -->
            <lightning-card icon-name="" variant="base" class="custom-card slds-m-top_xx-small slds-card_boundary">
                <div class="slds-p-around_small slds-m-top_xx-small">
                    <div class="slds-scrollable_y custom-scroll">
                        <table class="slds-table slds-table_bordered slds-table_fixed-layout custom-table">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th scope="col">
                                        <div class="slds-truncate" title="Nomor Kartu">Nomor Kartu</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Nama">Nama</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="CIF">CIF</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Jenis Kartu">Jenis Kartu</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Status">Status</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Action">Action</div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- <template for:each={processedCustomerData} for:item="data">
                                    <template for:each={data.cardlink} for:item="cardlink" for:index="index">
                                        <tr key={cardLink.cardNumber} class="slds-hint-parent">
                                            <td>{cardlink.cardNumber}</td>
                                            <td>{data.demografi.namaSesuaiIdentitas}</td>
                                            <td>{cardlink.cifno}</td>
                                            <td>{cardlink.productType}</td>
                                            <td>{cardlink.status}</td>
                                            <td>
                                                <lightning-button-menu alternative-text="Action"
                                                    icon-name="utility:down"
                                                    class="slds-m-left_x-small custom-button-menu"
                                                    menu-alignment="auto">
                                                    <lightning-menu-item label="Data Transaksi" value="data_transaksi"
                                                        data-nomor-kartu={cardlink.cardNumber}
                                                        onclick={handleTransaksiAction}
                                                        onclose={handleCloseMutasiKredit}
                                                        is-close-hidden={isCloseHidden}></lightning-menu-item>
                                                    <lightning-menu-item label="Data Kartu" value="data_kartu"
                                                        data-nomor-kartu={cardlink.cardNumber}
                                                        onclose={handleCloseDataKartu}
                                                        onclick={handleDataKartuAction}></lightning-menu-item>
                                                </lightning-button-menu>
                                            </td>
                                        </tr>
                                    </template>
                                </template> -->

                                <!-- FOR USING PORTOFOLIO API -->
                                <!-- <template for:each={processedCustomerData} for:item="data">
                                    <template if:true={data.hasCardlink}>
                                        <template for:each={data.cardlink} for:item="cardlink">
                                            <tr key={cardlink.cardNumber} class="slds-hint-parent">
                                                <td>{cardlink.cardNumber}</td>
                                                <td>{data.demografi.namaSesuaiIdentitas}</td>
                                                <td>{cardlink.cifno}</td>
                                                <td>{cardlink.productType}</td>
                                                <td>{cardlink.status}</td>
                                                <td>
                                                    <lightning-button-menu alternative-text="Action"
                                                        icon-name="utility:down"
                                                        class="slds-m-left_x-small custom-button-menu"
                                                        menu-alignment="auto">
                                                        <lightning-menu-item label="Data Transaksi"
                                                            value="data_transaksi"
                                                            data-nomor-kartu={cardlink.cardNumber}
                                                            onclick={handleTransaksiAction}
                                                            onclose={handleCloseMutasiKredit}
                                                            is-close-hidden={isCloseHidden}></lightning-menu-item>
                                                        <lightning-menu-item label="Data Kartu" value="data_kartu"
                                                            data-nomor-kartu={cardlink.cardNumber}
                                                            onclose={handleCloseDataKartu}
                                                            onclick={handleDataKartuAction}></lightning-menu-item>
                                                    </lightning-button-menu>
                                                </td>
                                            </tr>
                                        </template>
                                    </template>
                                </template> -->
                                <!-- END FOR USING PORTOFOLIO API -->

                                <!-- FOR USING CARDLINK API -->
                                <!-- <template for:each={cardData} for:item="card"> -->
                                <template if:true={cardData}>
                                    <tr key={cardInfo.customerNumber} class="slds-hint-parent">
                                        <td>{cardInfo.customerNumber}</td>
                                        <td>{cardInfo.namaLengkap}</td>
                                        <td>{cardInfo.customerNumber}</td>
                                        <td>{cardInfo.jenisKartu}</td>
                                        <td>{cardInfo.status}</td>
                                        <td>
                                            <lightning-button-menu alternative-text="Action" icon-name="utility:down"
                                                class="slds-m-left_x-small custom-button-menu" menu-alignment="auto">
                                                <lightning-menu-item label="Data Transaksi" value="data_transaksi"
                                                    data-nomor-kartu={cardInfo.customerNumber}
                                                    onclick={handleTransaksiAction} onclose={handleCloseMutasiKredit}
                                                    is-close-hidden={isCloseHidden}></lightning-menu-item>
                                                <lightning-menu-item label="Data Kartu" value="data_kartu"
                                                    data-nomor-kartu={cardInfo.customerNumber}
                                                    onclose={handleCloseDataKartu}
                                                    onclick={handleDataKartuAction}></lightning-menu-item>
                                            </lightning-button-menu>
                                        </td>
                                    </tr>
                                </template>
                                <!-- END FOR USING CARDLINK API -->

                            </tbody>
                        </table>
                    </div>
                </div>

            </lightning-card>


            <!-- End Kredit Protofolio Section -->

            <!-- Mutasi Kredit Section -->
            <template if:true={showMutasiKredit}>
                <lightning-card icon-name="" variant="base" class="custom-card slds-m-top_xx-small slds-card_boundary">
                    <div class="scrollable-kredit-container">
                        <c-lwc-mutasi-rekening-kredit-component class="mutasi-kredit-component"
                            onclose={handleCloseMutasiKredit} no-kartu={selectedNomorKartu}
                            record-id={recordId}></c-lwc-mutasi-rekening-kredit-component>
                    </div>
                </lightning-card>
            </template>
            <!-- End Mutasi Kredit Section -->

            <!-- Data Kartu Section -->
            <template if:true={showDataKartu}>
                <lightning-card icon-name="" variant="base" class="custom-card slds-m-top_xx-small slds-card_boundary">
                    <div class="scrollable-data-kartu-container">
                        <c-lwc-data-kartu-kredit-component class="data-kartu-component" onclose={handleCloseDataKartu}
                            no-kartu={selectedNomorKartu} record-id={recordId}></c-lwc-data-kartu-kredit-component>
                    </div>
                </lightning-card>
            </template>
            <!-- EndData Kartu Section -->
        </template>
        <!-- End Result Data Section -->

    </template>
</template>