<!--
  @description       : DETAIL ASSETS
  @author            : Ahmad Yazid Munif
  @group             : 
  @last modified on  : 11-24-2025
  @last modified by  : Ahmad Yazid Munif
-->
<template>
    <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
            <header class="slds-modal__header">
                <lightning-icon icon-name="custom:custom57" size="small" class="icon-left"></lightning-icon>
                <span class="card-title">{modalTitle}</span>
            </header>

            <!-- Modal Body -->
            <div class="slds-modal__content slds-p-around_medium">
                <div class="slds-grid slds-gutters">
                    <div class="slds-col slds-size_1-of-2">
                        <c-custom-lookup
                            label="Currency"
                            placeholder="currency"
                            data-field="Currency__c"
                            icon-name="standard:location"
                            object-api-name="Master_Data__c"
                            fields="Name, Exchange_Rate__c"
                            record-type-name="Exchange Rate"
                            record-id={formData.Currency__c}
                            onrecordselected={handleLookUpSelected}
                            display-text={section}>
                        </c-custom-lookup>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <lightning-input name="Exchange_Rate__c" label="Exchange Rate" value={exchangeRate} type="number" onchange={handleInputChange} disabled></lightning-input>
                    </div>
                </div>

                <div class="slds-grid slds-gutters">
                    <div class="slds-col slds-size_1-of-2">
                        <lightning-input name="Amount__c" label="Amount" value={formData.Amount__c} type="number" onchange={handleInputChange}></lightning-input>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <lightning-input name="Amount_IDR__c" label="Amount IDR" value={formData.Amount_IDR__c} type="number" onchange={handleInputChange} disabled></lightning-input>
                    </div>
                </div>

                <div class="slds-grid slds-gutters">
                    <div class="slds-col slds-size_1-of-2">
                        <c-custom-lookup
                            label="Section"
                            placeholder="Section"
                            data-field="Section__c"
                            icon-name="standard:location"
                            object-api-name="Master_Data__c"
                            fields="Name, Section__c, Section_Title__c, BSN_ID__c, BSN__r.Name"
                            record-type-name="Asset Section"
                            onrecordselected={handleLookUpSelected}
                            onrecordcleared={handleLookUpCleared}
                            record-id={formData.Section__c}
                            display-text={section}>
                        </c-custom-lookup>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <c-custom-lookup
                            label="Category"
                            placeholder="Category..."
                            data-field="Category__c"
                            icon-name="standard:location"
                            object-api-name="Master_Data__c"
                            fields="Name, Section__c, Section_Title__c, BSN_ID__c, BSN__r.Name"
                            record-type-name="Asset Category"
                            section-name={section}
                            record-id={formData.Category__c}
                            onrecordselected={handleLookUpSelected}
                            display-text={detailInsuredName}
                            >
                        </c-custom-lookup>
                    </div>
                </div>
                <template for:each={sectionList} for:item="section">
                    <div class="slds-m-top_medium" key={section.id}>
                        <lightning-card>    
                            <div class="section-header" >
                                <div class="section-title">
                                    <lightning-icon 
                                        icon-name="custom:custom27"
                                        size="small"
                                        class="slds-m-right_x-small">
                                    </lightning-icon>
                                    <span>{section.label}</span>
                                </div>
                            </div>
                            <div class="slds-grid slds-wrap slds-gutters">
                                <template for:each={section.fields} for:item="field">
                                    <!-- TEXT -->
                                        <template if:true={field.isText}>
                                            <div key={field.apiName} class="slds-col slds-size_1-of-2">
                                                <lightning-input 
                                                    type="text" 
                                                    label={field.label} 
                                                    name={field.apiName} 
                                                    value={field.value}
                                                    onchange={handleInputChange}>
                                                </lightning-input>
                                            </div>
                                        </template>

                                        <!-- TEXT AREA -->
                                        <template if:true={field.isTextArea}>
                                            <div key={field.apiName} class="slds-col slds-size_1-of-2">
                                                <lightning-textarea
                                                    label={field.label}
                                                    name={field.apiName}
                                                    value={field.value}
                                                    onchange={handleInputChange}>
                                                </lightning-textarea>
                                            </div>
                                        </template>

                                        <!-- Read Only -->
                                        <template if:true={field.isReadonly}>
                                            <div key={field.apiName} class="slds-col slds-size_1-of-2">
                                                <lightning-input 
                                                    type="text" 
                                                    label={field.label} 
                                                    name={field.apiName} 
                                                    value={field.value}
                                                    onchange={handleInputChange} 
                                                    disabled>
                                                </lightning-input>
                                            </div>
                                        </template>

                                        <!-- NUMBER -->
                                        <template if:true={field.isNumber}>
                                            <div key={field.apiName} class="slds-col slds-size_1-of-2">
                                                <lightning-input 
                                                    type="number" 
                                                    label={field.label} 
                                                    name={field.apiName} 
                                                    value={field.value}
                                                    onchange={handleInputChangeNumber}>
                                                </lightning-input>
                                            </div>
                                        </template>

                                        <!-- GEOLOCATION -->
                                        <template if:true={field.isGeolocation}>
                                            <div key={field.apiName} class="slds-col slds-size_1-of-2 slds-grid slds-wrap">
                                                <div class="slds-col slds-size_1-of-2">
                                                    <lightning-input
                                                        type="number"
                                                        step="0.000001"
                                                        label={field.latitudeLabel}
                                                        name={field.latitudeName}
                                                        value={field.latitude}
                                                        onchange={handleInputChange}>
                                                    </lightning-input>
                                                </div>
                                                <div class="slds-col slds-size_1-of-2">
                                                    <lightning-input
                                                        type="number"
                                                        step="0.000001"
                                                        label={field.longitudeLabel}
                                                        name={field.longitudeName}
                                                        value={field.longitude}
                                                        onchange={handleInputChange}>
                                                    </lightning-input>
                                                </div>
                                            </div>
                                        </template>

                                        <!-- PICKLIST -->
                                        <template if:true={field.isPicklist}>
                                            <div key={field.apiName} class="slds-col slds-size_1-of-2">
                                                <lightning-combobox
                                                    label={field.label}
                                                    name={field.apiName}
                                                    value={field.value}
                                                    placeholder="Select an option"
                                                    options={field.options}
                                                    onchange={handleInputChange}>
                                                </lightning-combobox>
                                            </div>
                                        </template>

                                        <!-- LOOKUP -->
                                        <template if:true={field.isLookup}>
                                            <div key={field.apiName}  class="slds-col slds-size_1-of-2 slds-p-horizontal_x-small slds-p-vertical_none">
                                                <c-custom-lookup
                                                    label={field.label}
                                                    placeholder={field.label}
                                                    icon-name="standard:location"
                                                    object-api-name={field.lookupObject}
                                                    fields={field.fieldsToQuery}
                                                    record-type-name={field.filter}
                                                    data-field={field.apiName}
                                                    province-id={provinceId} 
                                                    city-id={cityId}
                                                    record-id={field.value}
                                                    show-data={field.showData}
                                                    onrecordselected={handleLookUpSelected}
                                                    onrecordcleared={handleLookUpCleared}
                                                    >
                                                </c-custom-lookup>

                                                <template if:true={field.isAddress}>
                                                    <lightning-input 
                                                        type="text" 
                                                        label="Address Description"
                                                        placeholder="Enter street / building details"
                                                        value={addressDescription}
                                                        name="Address_Description__c"
                                                        onchange={handleInputChange}>
                                                    </lightning-input>
                                                </template>
                                            </div>
                                        </template>
                                </template>
                            </div>
                        </lightning-card>
                    </div>
                </template>
            </div>

            <!-- Modal Footer -->
            <footer class="slds-modal__footer">
                <div class="slds-grid slds-grid_align-center slds-m-around_medium">
                    <lightning-button variant="neutral" label="Cancel" onclick={handleCloseDetailAsset}></lightning-button>
                    <lightning-button variant="brand" label="Save" onclick={handleSaveDetailAsset}></lightning-button>
                    <!-- <lightning-button variant="brand" label="Save" onclick={handleSaveDetailInsured}></lightning-button> -->
                </div>
            </footer>
        </div>
    </section>
    <!--div class="slds-backdrop slds-backdrop_open"></div-->
</template>