<template>
    <div class="container-root">
        <template if:true={isLoading}>
            <lightning-spinner alternative-text="Loading..." size="small"></lightning-spinner>
        </template>
        
        <div class="left-col">
            <lightning-record-edit-form object-api-name="Location">
                <lightning-messages></lightning-messages>
                <lightning-input-field 
                    field-name="Country__c" 
                    value={country} 
                    onchange={handleCountryChange}>
                </lightning-input-field>
                <lightning-input-field 
                    field-name="Province__c" 
                    value={province} 
                    onchange={handleProvinceChange}>
                </lightning-input-field>
                <lightning-input-field 
                    field-name="City__c" 
                    value={city} 
                    onchange={handleCityChange}>
                </lightning-input-field>
                <lightning-input-field 
                    field-name="Zip_Code__c" 
                    value={zip} 
                    onchange={handleZipChange}>
                </lightning-input-field>
            </lightning-record-edit-form>
        </div>

        <div class="right-col">
            <div class="search-wrapper" style="position:relative;">
                <lightning-input
                    type="search"
                    label="Address"
                    placeholder="Search Locations..."
                    value={addressSearch}
                    onchange={handleAddressSearch}
                    onfocus={handleSearchFocus}>
                </lightning-input>

                <template if:true={showDropdown}>
                    <div class="dropdown-box">
                        <template if:true={addressOptions}>
                            <template for:each={addressOptions} for:item="opt">
                                <div class="opt-row" key={opt.value} data-id={opt.value} onclick={handleSelectAddress}>
                                    <div class="opt-label">{opt.label}</div>
                                    <div class="opt-sub">{opt.subLabel}</div>
                                </div>
                            </template>
                        </template>
                        <template if:true={noResults}>
                            <div class="no-res">No results found</div>
                        </template>
                    </div>
                </template>
            </div>
            
            <lightning-textarea 
                label="Address Description" 
                value={selectedAddressDesc} 
                disabled={isTextareaDisabled}
                onchange={handleDescriptionChange}>
            </lightning-textarea>
        </div>
    </div>
</template>